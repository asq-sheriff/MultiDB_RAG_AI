# üéØ Claude Code Session Memory Protocol

## Purpose
Quick, lightweight session continuity for therapeutic AI healthcare platform development. Heavy documentation is already loaded via CLAUDE.md and docs/ auto_include.

---

## üöÄ Session Start (30 seconds)
```bash
# Quick orientation - what changed since last session?
cat .claude-context/session-memory.md | grep -A 3 "ACTIVE ISSUES\|LAST CHANGES"
```

Key Questions:
1. Any BLOCKING issues from last session?
2. What was I working on? (check "LAST CHANGES")
3. Any failed tests to address?

---

## üìù During Session - Minimal Updates

### Critical Updates Only (Add to session-memory.md):

**üî¥ BLOCKING Issue Found**
```text
BLOCKING: [issue] | Impact: [what breaks] | File: [where]
```

**‚úÖ Major Fix Applied**
```text
FIXED: [issue] ‚Üí [solution] | Files: [changed files]
```

**üîÑ Architecture Change**
```text
CHANGED: [component] from [old] to [new] | Reason: [why]
```

**üí° Key Discovery**
```text
LEARNED: [insight] | Applies to: [where/when to use]
```

### Quick Logging Commands:
```bash
# Add blocking issue
echo "$(date +%H:%M) BLOCKING: $1" >> .claude-context/session-memory.md

# Add fix
echo "$(date +%H:%M) FIXED: $1" >> .claude-context/session-memory.md

# Add discovery
echo "$(date +%H:%M) LEARNED: $1" >> .claude-context/session-memory.md
```

---

## üèÅ Session End (2 minutes max)

### Minimal Session Summary Template:
```markdown
## Session: [DATE] [TIME]
Branch: [current branch]

### ACTIVE ISSUES (carry forward)
- [ ] [Blocking issue if unresolved]
- [ ] [High priority issue]

### LAST CHANGES (what I did)
- [Primary change/fix with file]
- [Secondary change/fix with file]

### NEXT SESSION FOCUS
- [One clear priority]

### CONTEXT NOTES (if architecture/config changed)
- [Only if services/ports/config changed]
```

---

## üîç What NOT to Track (Already in Auto-Include)

### Already in CLAUDE.md:
- Service ports and architecture (12 Go + 6 Python services)
- File locations and structure
- Database connections (PostgreSQL, MongoDB, Redis, ScyllaDB)
- HIPAA requirements and compliance status
- Test categories (9 total) and performance SLAs
- **NEW**: Current implementation gaps and priority roadmap
- **NEW**: Requirements document references and clinical outcomes

### Already in docs/ARCHITECTURE.md:
- System design details (858 lines authoritative)
- Service dependencies and communication patterns
- Technology stack and deployment architecture

### Already in docs/reqs/ (Requirements Documents):
- **AI Features**: `ai_features.md` - 28-week AI implementation roadmap
- **Tech Infrastructure**: `tech_features.md` - Platform and infrastructure requirements
- **Feature Priorities**: `features_priority.md` - Master prioritization matrix with safety-first approach

### Already in TESTING_GUIDE.md:
- Test commands and validation workflows
- Healthcare-specific testing requirements

### Already in Strategic Documents:
- `Strategic_Technology_Roadmap.md` - 18-month technology evolution
- `Internal_Product_Roadmap.md` - Business strategy and market analysis

**Don't duplicate - just reference!**

---

## üíæ Session Memory File Structure

Keep `.claude-context/session-memory.md` under 100 lines:

```markdown
# Active Session Memory - MultiDB Therapeutic AI

## ACTIVE ISSUES (Maximum 3)
- [ ] BLOCKING: [issue]
- [ ] HIGH: [issue]
- [ ] MEDIUM: [issue]

## LAST CHANGES (Last 5 modifications)
1. [timestamp] [change]
2. [timestamp] [change]
3. [timestamp] [change]
4. [timestamp] [change]
5. [timestamp] [change]

## WORKING CONTEXT
Current Branch: [branch]
Current Focus: [what you're working on]
Failed Tests: [any failing test categories]

## NEXT SESSION FOCUS
Primary: [main task to continue]
```

---

## ‚ö° Quick Reference Card

### When to Update Memory:

| Event | Action | Priority |
|-------|--------|----------|
| HIPAA test fails | Add to ACTIVE ISSUES | BLOCKING |
| Crisis detection failure | Add to ACTIVE ISSUES | BLOCKING |
| Patient safety issue | Add to ACTIVE ISSUES | BLOCKING |
| Service won't start | Add to ACTIVE ISSUES | HIGH |
| UI accessibility failure | Add to ACTIVE ISSUES | HIGH |
| MongoDB ‚Üí PostgreSQL migration | Add to LAST CHANGES + CONTEXT | HIGH |
| Agentic RAG implementation | Add to LAST CHANGES + CONTEXT | HIGH |
| Major therapeutic module added | Add to LAST CHANGES | HIGH |
| Architecture modified | Add to LAST CHANGES + CONTEXT | HIGH |
| Performance degraded | Note in WORKING CONTEXT | MEDIUM |
| Clinical outcomes validated | Add to LAST CHANGES | MEDIUM |
| Minor fix | Add to LAST CHANGES (if room) | LOW |

### Don't Log:
- ‚ùå Information already in CLAUDE.md (architecture, gaps, roadmap)
- ‚ùå Requirements details (they're in docs/reqs/)
- ‚ùå Standard commands (they're in Makefile)
- ‚ùå Architecture details (they're in docs/ARCHITECTURE.md)
- ‚ùå Strategic plans (they're in docs/Strategic_Technology_Roadmap.md)
- ‚ùå HIPAA controls (they're in docs/compliance/)
- ‚ùå Clinical outcomes targets (they're in requirements docs)
- ‚ùå Small code tweaks without impact
- ‚ùå Exploratory reading/research

---

## üÜò Emergency Recovery

If session memory is lost, check (in order):
1. Git log: `git log --oneline -5`
2. Recent test results: `ls -t test-results/ | head -5`
3. Changed files: `git status`

---

## üìä Session Health Check

Before ending session, verify:
- [ ] No BLOCKING issues left undocumented
- [ ] At least one LAST CHANGE recorded
- [ ] NEXT SESSION FOCUS is clear
- [ ] Session memory file < 100 lines

---

## üéØ The Golden Rule

**Only track what's different from the baseline documentation.**

If it's already in:
- CLAUDE.md
- docs/ARCHITECTURE.md  
- TESTING_GUIDE.md
- README.md

Then DON'T duplicate it in session memory!

---

## Minimal Bash Aliases

Add to `.bashrc` or `.zshrc`:
```bash
# Quick session memory updates
alias cs-block='echo "$(date +%H:%M) BLOCKING: " >> .claude-context/session-memory.md && echo "Added blocking issue"'
alias cs-fix='echo "$(date +%H:%M) FIXED: " >> .claude-context/session-memory.md && echo "Added fix"'
alias cs-learn='echo "$(date +%H:%M) LEARNED: " >> .claude-context/session-memory.md && echo "Added learning"'
alias cs-show='tail -20 .claude-context/session-memory.md'
alias cs-clean='cp .claude-context/session-memory.md .claude-context/archive/session-$(date +%Y%m%d-%H%M).md && echo "# Active Session Memory" > .claude-context/session-memory.md'

# Therapeutic AI project-specific aliases  
alias cs-crisis='echo "$(date +%H:%M) CRISIS: " >> .claude-context/session-memory.md && echo "Added crisis detection issue"'
alias cs-hipaa='echo "$(date +%H:%M) HIPAA: " >> .claude-context/session-memory.md && echo "Added HIPAA compliance issue"'
alias cs-ui='echo "$(date +%H:%M) UI: " >> .claude-context/session-memory.md && echo "Added UI/accessibility issue"'
alias cs-ai='echo "$(date +%H:%M) AI: " >> .claude-context/session-memory.md && echo "Added therapeutic AI issue"'

# Quick requirement references
alias reqs='echo "üìã Requirements: docs/reqs/features_priority.md (master priority matrix)"'
alias ai-reqs='echo "ü§ñ AI Features: docs/reqs/ai_features.md (28-week roadmap)"'
alias tech-reqs='echo "üèóÔ∏è Infrastructure: docs/reqs/tech_features.md (platform requirements)"'
```

---

*Remember: The goal is CONTINUITY not COMPLETENESS. Keep it lean!*